"""malware-passwords archive password cracker - by iam-py-test"""
import os
import sys
import pyzipper
import json
import requests
import argparse

# download passwords
passwords = requests.get('https://raw.githubusercontent.com/iam-py-test/malware-passwords/main/passwords.txt').text.split('\n')

parser = argparse.ArgumentParser(description='Crack the password on a password-protected malware archive')
parser.add_argument("file",help="The archive to crack")
args = parser.parse_args()

try:
	os.mkdir("found")
except:
	pass
found_match = False

for password in passwords:
	try:
		with pyzipper.AESZipFile(args.file) as zf:
			zf.pwd = password.encode()
			f = zf.extractall("found/{}".format(args.file))
		print("Extracted with password {}".format(password))
		found_match = True
	except:
		pass
if found_match == False:
	print("No password found")
